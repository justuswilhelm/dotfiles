#!/usr/bin/env fish
set_color blue
echo
echo "               =============="
echo "               = pufferfish ="
echo "               =============="
echo
set_color yellow
printf "\
                    /-  :h:  -/
               :+` `NN..oMo..NN` `+:
               :Mm+yNMmddhddmMNy+mM:
           /Mh:oNmy+:.........:+yNNo:hM/
         `  :MMh/.:m:.:N:.:N:.:m/./hMM:  `
        -NNyNm:..-...-...-...-....../mNyNN:
   os++:``sMh.../m:.:m:.:m:.:m:.......hMs`
   MmsydNdMd.......-/+/-........+/.-o-.dM:.
   dN+::/mM/......oNhsyNh:......sNydm:./MMm
   `dNy/:dN-...../Ms...-sd:......-/:..oNm+
   `dNy/:dN-.....sM:..................oNm+
   dN+::/mM/...../Ms....+d:............/MMd
   MmsydNdMd......oNhshh--.............dM-
   oso+:``sMh......-/+/-..............hMs`
        -NNyNm:...................../mNyNN:
         `  :MMh/................./hMM:  `
           /Mh:oNNy+:.........:+yNNo:hM/
               :Mm+yNMmddhddmMNy+mM:
               :+` `NN..oMo..NN` `+:
                    /-  :h:  -/

" | cat
set_color normal

set -l DOTFILES "$HOME/.dotfiles"
set -l XDG_CONFIG_HOME "$HOME/.config"

echo "Ensure XDG_CONFIG_HOME"
echo "----------------------"
mkdir -p "$XDG_CONFIG_HOME"
or exit 1
set_color green
echo "All good!"
set_color normal
echo

echo "Linking Config Files"
echo "-----------------------"
ln -sfv $DOTFILES/bin $HOME
and ln -sfv $DOTFILES/fish $HOME/.config
and ln -sfv $DOTFILES/nvim $HOME/.config
and ln -fv $DOTFILES/tmux/tmux.conf $HOME/.tmux.conf
or exit 1
set_color green
echo "All good!"
set_color normal
echo

echo "Updating neovim"
nvim +PlugInstall +qall
or exit 1
set_color green
echo "All good!"
set_color normal
echo

if string match -ev fish $SHELL > /dev/null
    set_color red
    echo "Warning"
    echo "-------"
    echo "This command was not executed from fish"
    echo "Please ensure that fish is set as your login shell"
    echo "For more info, please refer to"
    echo
    set_color blue
    echo "https://github.com/justuswilhelm/pufferfish#installing-fish"
    set_color normal
    echo
end

set_color green
echo "All Done!"
set_color normal
